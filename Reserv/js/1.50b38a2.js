(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"45Ms":function(t,o,e){"use strict";var n=e("UtCN"),s=e.n(n);s.a},UtCN:function(t,o,e){},ixq0:function(t,o,e){"use strict";e.r(o);var n=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[t.loadingL?e("div",{staticClass:"column justify-center items-center content-center fit"},[e("q-spinner",{attrs:{color:"primary",size:"40px"}}),e("b",[t._v("Загрузка карты...")])],1):t._e()])},s=[];n._withStripped=!0;e("f3/d"),e("rGqo");var i={name:"YandexMap",props:{city:{type:String,default:null},markets:{type:Array,default:function(){return null}}},data:function(){return{myMap:null,cityL:this.city,marketsL:this.markets,coordsL:[55,34],zoomL:12,controlsL:["typeSelector","zoomControl"],mapTypeL:"map",loadingL:!0}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.onLoad()})},computed:{},watch:{city:function(t,o){this.cityL=t},cityL:function(t,o){console.log("cityL>>>"+t),this.setCity(t)},markets:function(t,o){this.marketsL=t},marketsL:function(t,o){this.setMarkets(t)},coordsL:function(t,o){this.setCoords(t)},zoomL:function(t,o){this.setZoom(t)}},methods:{onLoad:function(){ymaps.ready(this.onReady)},onReady:function(){this.myMap=new ymaps.Map(this.$el,{center:this.coordsL,zoom:this.zoomL,type:"yandex#".concat(this.mapTypeL),controls:this.controlsL},{autoFitToViewport:"always",suppressMapOpenBlock:!0}),this.myMap.events.add("boundschange",this.onBoundsChange),this.setCity(this.cityL),this.setMarkets(this.marketsL),this.loadingL=!1,console.log("ready")},setCoord:function(t){window.ymaps&&t&&this.myMap&&(console.log("coords>>>"+t),this.myMap.setCenter(t))},setCity:function(t){var o=this;window.ymaps&&t&&this.myMap&&(console.log("city>>>"+t),ymaps.geocode(t).then(function(t){var e=t.geoObjects.get(0),n=e.properties.get("boundedBy");o.coords=e.geometry.getCoordinates(),o.myMap.setBounds(n)}).catch(function(t){console.log(t)}))},setZoom:function(t){window.ymaps&&t&&this.myMap&&this.myMap.setZoom(t)},onBoundsChange:function(){var t=this,o=[],e=this.myMap.getBounds();this.myMap.geoObjects.each(function(n){n.objects.each(function(n){t.isPointInBounds(n.geometry.coordinates,e)&&o.push(n.id)})}),this.$emit("visibleIdsChange",o)},isPointInBounds:function(t,o){var e=t[0],n=t[1],s=o[0][0],i=o[1][0],a=o[0][1],c=o[1][1];return e>=s&&e<=i&&n>=a&&n<=c},setMarkets:function(t){var o=this;if(window.ymaps&&this.myMap&&(this.myMap.geoObjects.removeAll(),t)){var e=new ymaps.ObjectManager({clusterize:!0,gridSize:100});e.objects.options.set("preset","islands#greenDotIcon"),e.clusters.options.set("preset","islands#greenClusterIcons");t.forEach(function(t){t&&t.name&&e.add({type:"Feature",id:t.id,geometry:{type:"Point",coordinates:t.coord},properties:{hintContent:t.name,balloonContent:""},options:{}})}),e.objects.events.add(["click"],function(t){return o.$emit("baloonClick",t.get("objectId"))}),this.myMap.geoObjects.add(e);var n=e.getBounds();n&&this.myMap.setBounds(n,{checkZoomRange:!0})}},setCityHome:function(){var t=this;window.ymaps&&this.myMap&&ymaps.geolocation.get().then(function(o){return t.cityL=o.geoObjects.get(0).getLocalities()}).catch(function(t){console.log(t)})},fit:function(){window.ymaps&&this.myMap&&this.myMap.container.fitToViewport()},autoZoom:function(){}},beforeDestroy:function(){this.myMap&&this.myMap.geoObjects&&this.myMap.geoObjects.removeAll()}},a=i,c=(e("45Ms"),e("KHd+")),r=Object(c["a"])(a,n,s,!1,null,null,null);o["default"]=r.exports}}]);